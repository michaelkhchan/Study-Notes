### Introduction
---
#### WPA:
Wi-Fi Protected Access (WPA). Replacement for WEP. 
##### Key Features:
- Use Temporal Key Integrity Protocol (TKIP) - i.e., Dynamic Key for each packet.
- Use Message Integrity Checks to prevent modification of data and resending packets.
- Use 256-bit key.
- WPA Key = Wi-Fi password.

#### WPA2:
Upgrade of WPA. Based on Robust Security Network (RSN) mechanism.
##### Key Features:
Operates in 2 modes, Personal (PSK) & Enterprise (MGT).
- **WPA-PSK**: Uses pre-shared key (PSK). Everyone on the network uses the same password.
- **WPA-MGT**: Uses 802.1x & Radius server for authentication, authorization and accounting.
Both mode use CCMP (Counter Mode Cipher Block Chaining Message Authentication Code Protocol). 
- Based on AES. Provides integrity and authenticity verification. Stronger than TKIP.

#### The WPA 4-way Handshake:
Upon authentication (either by PSK or Radius server), there will be a 4-way handshake to exchange keys for message encryption (PTK & GTK).

For WPA Personal, the PTK is generated from the PMK, which derived from the PSK (created from the passphrase). The values to generate PSK are:
- Passphrase of Wi-Fi
- SSID (and its length)
- The number of iterations
- The length of the result key
Which are all known value except for the passphrase.

#### Vulnerabilities of WPA & WPA2:
- Vulnerable to Key reinstallation attack (KRACK).
- Vulnerable to hash cracking if weak passphrase is used.
- De-authentication Attack
- Password Brute Forcing
- MAC Spoofing to bypass access restrictions

### Exploitation
---
> [!note]
> **Prerequisite Condition for attacking WPA networks:**
> There has to be **existing clients connected** to the network during the attack for capturing the 4-way handshakes

##### De-authentication Attack
We can de-authenticate a connected client from the AP, and capture the WPA 4-way handshake when the client attempts to reconnect.

##### Brute Force Attack
Once the handshake is captured, we can attempt to crack the encrypted password via brute forcing with wordlists/dictionaries.

Tools for attacking WPA:
- wifite
- aircrack-ng suite
