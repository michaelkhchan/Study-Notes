### Introduction
---
Wi-Fi Protected Setup (WPS). An alternative to WPA for users to easily add devices to the network. PINs are usually located on the stickers on the Wi-Fi access point. (Physical Security)

##### Key Features:
4 modes of connections:
- **PIN Method**: Obtain a PIN from the device and enter into the Wi-Fi Access Point, or vice-versa
- **Push Button Method**: Push a button on both the device (can be virtual) and the Wi-Fi Access Point for connection.
	- Depreciated on recent smart phones.
- **NFC Method**: Optional. Bring device to Access Point for NFC connection.
- **USB Method**: Deprecated. Use USB to transfer data between device and Access Point.

>[!note]
>Access points that do not advertise WPS in the beacons are **IMMUNE** to the below attacks.

##### Vulnerabilities:
- Brute force attacks on the WPS PIN.
	- Usually WPS is enabled by default, and the PIN can be as easy as 12345678
- Pixie Dust Attacks. 
- Physical Vulnerabilities - If we can get close to the Wi-Fi Access Point, we may perform actions like pushing the WPS button, reading the PIN on the stickers, NFC connection, etc.

### Exploitation
---
##### Brute Force Attacks:
WPS PINs are only 8 digits, therefore very easily to crack. 

Two more points to note:
1. The last digit is used as checksum, therefore the security level of the PIN is just 7 digits.
2. When a PIN is verified, the first 4 digits are checked first, and will only proceed to the remaining 3 if the first 4 are correct.

Thus, the total combination of guess is just around 11000 trials. 

###### Remediations:
- Timeout for incorrect WPS PIN entries.
- Lock WPS for multiple incorrect entries.

##### Pixie Dust Attacks (PixieWPS):
An offline alternative of brute forcing. Only works on default WPS implementation of a few WIC manufacturers. Takes advantage of the weak random number generator in a few chipsets.

The theory behind is to brute force the PIN out of the two hashes sent by the Wi-Fi Access Point to the client device to show that it knows the PIN and is the legitimate access point.

##### Physical:
Many APs will have stickers on the back indicating the default passphrase / WPS PIN, alongside information such as MAC address, serial number, model, etc. Also check for the WPS button.













### Other Resources:
---
##### WIFI WPS WPA TESTER
- A phone app without needing Kali. (Use with caution, may be fishy)