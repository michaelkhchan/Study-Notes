### Capturing Packets
---
Suppose Wireshark is not available in the remote environment, we can use any tools that can capture packets and output to STDOUT, e.g., tcpdump, dumpcap, tshark, etc.

##### tcpdump:
```
sudo tcpdump -i wlan0mon -w - -U
```
- `-w -` is to write output to STDOUT instead of a file.
- `-U` is to output each packet as it arrives

##### dumpcap:
```
sudo dumpcap -i wlan0mon -w - -P
```
- `-P` for writing out as `.pcap` format.

##### tshark:
```
sudo tshark -i wlan0mon -w -
```

### Piping to Wireshark
---
##### Unnamed Pipes:
Piping locally:
```
sudo tcpdump -U -w - -i wlan0mon | wireshark -k -i -
```

Piping remotely using SSH:
```
ssh root@10.11.0.196 "sudo -S tcpdump -U -w - -i wlan0mon" | sudo wireshark -k -i -
```
- Basically just received the on-screen output from `tcpdump` via SSH, then piping into local Wireshark.

##### Named Pipes:
Opening a named pipe:
```
mkfifo /tmp/named_pipe
```

Then run Wireshark with the named pipe to read the pipe:
```
sudo wireshark -k -i /tmp/named_pipe
```

Lastly, we just have to write data to the named pipe to received output from Wireshark. 

Piping locally:
```
sudo tcpdump -U -w - -i wlan0mon > /tmp/named_pipe
```

Piping remotely using SSH:
```
ssh root@10.11.0.196 "sudo -S tcpdump -U -w - -i wlan0mon" > /tmp/named_pipe
```

### Wireshark Built-in
---
In the frontpage of Wireshark, only choose `External Capture` in the filter dropdown menu at the top right side.

Then click on `SSH remote capture: sshdump` right under the filter bar.

For the remote capture command:
```
sudo dumpcap -w -
```
- Just remove the interface.